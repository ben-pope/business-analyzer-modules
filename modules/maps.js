!function(e){"use strict";e.businessAnalyzer=e.businessAnalyzer||{};let o=null;function n(e){document.getElementById("mapLoadingMessage").style.display="none",document.getElementById("mapErrorMessage").textContent=e,document.getElementById("mapErrorMessage").style.display="block"}function t(t){try{const n=e.businessAnalyzer.currentBusiness||{},a=document.getElementById("competitorMap"),i=new google.maps.LatLngBounds,s=n.location;i.extend(new google.maps.LatLng(s.latitude,s.longitude)),t.forEach(e=>{e.location&&i.extend(new google.maps.LatLng(e.location.latitude,e.location.longitude))}),o=new google.maps.Map(a,{zoom:12,center:i.getCenter(),mapTypeControl:!0,streetViewControl:!0,fullscreenControl:!1,styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}]}),function(o){const n=e.businessAnalyzer.currentBusiness||{},t=n.location,a=new google.maps.Marker({position:{lat:t.latitude,lng:t.longitude},map:o,title:n.name,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0066cc",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:3,scale:12},zIndex:1e3}),i=new google.maps.InfoWindow({content:`\n        <div class="ba-map-info">\n          <h4 style="margin: 0 0 8px 0; color: #0066cc;">${n.name}</h4>\n          <p style="margin: 0; font-size: 13px;">${n.address}</p>\n          <p style="margin: 4px 0 0 0; font-size: 12px; color: #666;">‚≠ê ${n.rating}/5 (${n.reviewCount} reviews)</p>\n        </div>\n      `});a.addListener("click",()=>{i.open(o,a)})}(o),function(e,o){o.forEach((o,n)=>{if(!o.location)return;const t=new google.maps.Marker({position:{lat:o.location.latitude,lng:o.location.longitude},map:e,title:o.name,label:{text:(n+1).toString(),color:"white",fontWeight:"bold",fontSize:"14px"},icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#dc3545",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:2,scale:15}}),a=o.practiceAreas&&o.practiceAreas.length>0?`<p style="margin: 4px 0; font-size: 12px;"><strong>Practice Areas:</strong> ${o.practiceAreas.join(", ")}</p>`:"",i=o.website?`<p style="margin: 4px 0 0 0; font-size: 12px;"><a href="${o.website}" target="_blank" style="color: #0066cc;">Visit Website</a></p>`:"",s=new google.maps.InfoWindow({content:`\n          <div class="ba-map-info">\n            <h4 style="margin: 0 0 8px 0; color: #dc3545;">${o.name}</h4>\n            <p style="margin: 0; font-size: 13px;">${o.address}</p>\n            <p style="margin: 4px 0; font-size: 12px; color: #666;">‚≠ê ${o.rating}/5 (${o.reviewCount} reviews)</p>\n            <p style="margin: 4px 0; font-size: 12px; color: #666;">üìç ${o.distanceFormatted}</p>\n            ${a}\n            ${i}\n          </div>\n        `});t.addListener("click",()=>{s.open(e,t)})})}(o,t),o.fitBounds(i);const l=google.maps.event.addListener(o,"bounds_changed",function(){o.getZoom()>15&&o.setZoom(15),google.maps.event.removeListener(l)});document.getElementById("mapLoadingMessage").style.display="none"}catch(e){n("Failed to load map")}}e.businessAnalyzer.initCompetitorMap=function(o){if(!(e.businessAnalyzer.currentBusiness||{}).location||!o||0===o.length)return void n("Location data unavailable for mapping");const a=o.filter(e=>e.location&&e.location.latitude&&e.location.longitude);0!==a.length?(document.getElementById("mapLoadingMessage").style.display="block",document.getElementById("mapErrorMessage").style.display="none","undefined"!=typeof google&&google.maps?t(a):function(o){const t=e.GOOGLE_MAPS_API_KEY;if(!t)return void n("Google Maps API key not configured");const a=document.createElement("script");a.src=`https://maps.googleapis.com/maps/api/js?key=${t}&callback=googleMapsLoaded`,a.async=!0,a.defer=!0,e.googleMapsLoaded=o,document.head.appendChild(a)}(()=>{t(a)})):n("No competitor locations available for mapping")}}(window);